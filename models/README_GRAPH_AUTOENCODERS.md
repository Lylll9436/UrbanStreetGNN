# åŸå¸‚è¡—é“ç½‘ç»œå›¾è‡ªç¼–ç å™¨é¡¹ç›®

åŸºäºPyTorch Geometricå®ç°çš„ä¸‰ç§å›¾è‡ªç¼–ç å™¨æ¨¡å‹ï¼ˆGAEã€VGAEã€GraphMAEï¼‰ï¼Œç”¨äºå­¦ä¹ åŸå¸‚è¡—é“ç½‘ç»œçš„å›¾çº§åˆ«åµŒå…¥è¡¨ç¤ºã€‚

## ğŸ¯ é¡¹ç›®ç›®æ ‡

å°†åŸå¸‚è¡—é“ç½‘ç»œçš„æ¯ä¸ªego-graphç¼–ç ä¸ºå›ºå®šç»´åº¦çš„å‘é‡è¡¨ç¤ºï¼Œç”¨äºï¼š
- è¡—é“ç½‘ç»œç»“æ„åˆ†æ
- å›¾ç›¸ä¼¼åº¦è®¡ç®—
- ä¸‹æ¸¸ä»»åŠ¡ï¼ˆå¦‚å¼ºåŒ–å­¦ä¹ ã€åˆ†ç±»ã€èšç±»ç­‰ï¼‰

## ğŸ“‹ æ¨¡å‹æ¦‚è§ˆ

| æ¨¡å‹ | ç±»å‹ | æ ¸å¿ƒæ€æƒ³ | ä¼˜åŠ¿ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|------|----------|
| **GAE** | ç¡®å®šæ€§è‡ªç¼–ç å™¨ | ç¼–ç -è§£ç é‡å»ºè¾¹ | ç®€å•ç¨³å®š | å¿«é€Ÿbaseline |
| **VGAE** | å˜åˆ†è‡ªç¼–ç å™¨ | å­¦ä¹ æ½œåœ¨åˆ†å¸ƒ | é²æ£’æ€§å¼º | **æ¨èç”¨äºè¡—é“ç½‘ç»œ** |
| **GraphMAE** | æ©ç è‡ªç¼–ç å™¨ | æ©ç ç‰¹å¾é‡å»º | SOTAæ€§èƒ½ | ç‰¹å¾ä¸°å¯Œåœºæ™¯ |

## ğŸ—ï¸ æ¨¡å‹æ¶æ„å›¾

### 1ï¸âƒ£ GAE (Graph AutoEncoder) æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         GAE æ¨¡å‹æ¶æ„                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¾“å…¥å›¾æ•°æ®
    â”‚
    â”‚  èŠ‚ç‚¹ç‰¹å¾: [N, 2]  (åº¦æ•°, ä¸­å¿ƒæ€§)
    â”‚  è¾¹ç‰¹å¾:   [E, 3]  (ç±»å‹, å®½åº¦, é•¿åº¦)
    â”‚  è¾¹ç´¢å¼•:   [2, E]
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     èŠ‚ç‚¹ç‰¹å¾ç¼–ç å™¨ (MLP)               â”‚
â”‚  Linear(2 â†’ 256) â†’ ReLU â†’ Dropout     â”‚
â”‚  â†’ Linear(256 â†’ 256)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚  èŠ‚ç‚¹åµŒå…¥: [N, 256]
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     GNNæ¶ˆæ¯ä¼ é€’ (Ã—3å±‚)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  GCNConv(256 â†’ 256)             â”‚ â”‚
â”‚  â”‚  â†’ ReLU â†’ Dropout               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  GCNConv(256 â†’ 256)             â”‚ â”‚
â”‚  â”‚  â†’ ReLU â†’ Dropout               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  GCNConv(256 â†’ 256)             â”‚ â”‚
â”‚  â”‚  â†’ ReLU â†’ Dropout               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚  æ›´æ–°åèŠ‚ç‚¹åµŒå…¥: [N, 256]
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å›¾çº§åˆ«æ± åŒ–                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Mean Pool   â”‚ Max Pool    â”‚       â”‚
â”‚  â”‚ [1, 256]    â”‚ [1, 256]    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚ Concatenate â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                â”‚  [1, 512]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å›¾åµŒå…¥æŠ•å½±å±‚                       â”‚
â”‚  Linear(512 â†’ 256) â†’ ReLU â†’ Dropout  â”‚
â”‚  â†’ Linear(256 â†’ 128)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
        ã€å›¾åµŒå…¥ zã€‘
          [1, 128]  â—„â”€â”€â”€â”€â”€â”€ è¿™æ˜¯æœ€ç»ˆè¾“å‡ºçš„å›¾è¡¨ç¤º
                â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚              â”‚
                â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  èŠ‚ç‚¹æŠ•å½±          â”‚   â”‚  é“¾æ¥é¢„æµ‹è§£ç å™¨       â”‚
    â”‚  z â†’ [N, 256]     â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚ å†…ç§¯è§£ç         â”‚  â”‚
           â”‚                â”‚  â”‚ Ïƒ(z[i]Â·z[j])   â”‚  â”‚
           â”‚                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â–º è¾¹å­˜åœ¨æ¦‚ç‡         â”‚
                               [E]                 â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æŸå¤±å‡½æ•°: é‡å»ºæŸå¤± (Binary Cross Entropy)
         L = -[log(p_pos) + log(1 - p_neg)]
```

### 2ï¸âƒ£ VGAE (Variational Graph AutoEncoder) æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VGAE æ¨¡å‹æ¶æ„ (å˜åˆ†ç‰ˆæœ¬)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¾“å…¥å›¾æ•°æ®
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     èŠ‚ç‚¹ç‰¹å¾ç¼–ç å™¨ (MLP)               â”‚
â”‚  Linear(2 â†’ 256) â†’ ReLU â†’ Dropout     â”‚
â”‚  â†’ Linear(256 â†’ 256)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚  èŠ‚ç‚¹åµŒå…¥: [N, 256]
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     GNNæ¶ˆæ¯ä¼ é€’ (Ã—3å±‚)                â”‚
â”‚  GCNConv â†’ ReLU â†’ Dropout (Ã—3)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚  æ›´æ–°åèŠ‚ç‚¹åµŒå…¥: [N, 256]
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å›¾çº§åˆ«æ± åŒ–                         â”‚
â”‚  Mean Pool âŠ• Max Pool â†’ [1, 512]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â–¼             â–¼             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  å‡å€¼åˆ†æ”¯ (Î¼)     â”‚ â”‚  å¯¹æ•°æ–¹å·®åˆ†æ”¯     â”‚
    â”‚  Linear(512â†’256) â”‚ â”‚  (log ÏƒÂ²)        â”‚
    â”‚  â†’ReLUâ†’Dropout   â”‚ â”‚  Linear(512â†’256) â”‚
    â”‚  â†’Linear(256â†’128)â”‚ â”‚  â†’ReLUâ†’Dropout   â”‚
    â”‚                  â”‚ â”‚  â†’Linear(256â†’128)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                    â”‚
             â”‚  Î¼: [1, 128]       â”‚  log ÏƒÂ²: [1, 128]
             â”‚                    â”‚
             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   é‡å‚æ•°åŒ–æŠ€å·§ (Reparameterization)  â”‚
    â”‚                                     â”‚
    â”‚   Îµ ~ N(0, I)                      â”‚
    â”‚   z = Î¼ + Ïƒ Â· Îµ                    â”‚
    â”‚                                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
           ã€å›¾åµŒå…¥ zã€‘
             [1, 128]  â—„â”€â”€â”€â”€â”€â”€ ä»æ½œåœ¨åˆ†å¸ƒé‡‡æ ·
                   â”‚
                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚              â”‚              â”‚
                   â–¼              â–¼              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ èŠ‚ç‚¹æŠ•å½±      â”‚  â”‚ é“¾æ¥è§£ç      â”‚  â”‚ KLæ•£åº¦è®¡ç®—   â”‚
         â”‚ zâ†’[N, 256]   â”‚  â”‚ Ïƒ(z[i]Â·z[j])â”‚  â”‚ KL(q||p)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                â”‚                 â”‚                 â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   æ€»æŸå¤±å‡½æ•°          â”‚
                        â”‚  L = L_recon         â”‚
                        â”‚      + Î²Â·L_KL        â”‚
                        â”‚                      â”‚
                        â”‚  L_recon: é‡å»ºæŸå¤±    â”‚
                        â”‚  L_KL: KLæ•£åº¦        â”‚
                        â”‚  Î²: KLæƒé‡(å¯é€€ç«)   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æŸå¤±å‡½æ•°: L_total = BCE(é‡å»ºè¾¹) + Î²Â·KL(N(Î¼,ÏƒÂ²) || N(0,I))
         æ”¯æŒKLé€€ç«: Î²ä»0.01é€æ¸å¢åŠ åˆ°0.1
```

### 3ï¸âƒ£ GraphMAE (Graph Masked AutoEncoder) æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GraphMAE æ¨¡å‹æ¶æ„ (æ©ç ç‰ˆæœ¬)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¾“å…¥å›¾æ•°æ®
    â”‚
    â”‚  èŠ‚ç‚¹ç‰¹å¾: [N, 2]
    â”‚  è¾¹ç‰¹å¾:   [E, 3]
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     æ©ç ç­–ç•¥ (Masking Strategy)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ éšæœºé€‰æ‹©15%çš„èŠ‚ç‚¹è¿›è¡Œæ©ç         â”‚ â”‚
â”‚  â”‚ æ©ç èŠ‚ç‚¹ç‰¹å¾ â†’ [MASK] token     â”‚ â”‚
â”‚  â”‚                                 â”‚ â”‚
â”‚  â”‚ åŸå§‹ç‰¹å¾: [1.2, 0.8] â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚ æ©ç ç‰¹å¾: [0.0, 0.0] â—„â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚  æ©ç åç‰¹å¾: [N, 2]
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     èŠ‚ç‚¹ç‰¹å¾ç¼–ç å™¨ (å«æ©ç token)       â”‚
â”‚  Mask Token: å¯å­¦ä¹ å‚æ•° [1, 2]        â”‚
â”‚  Linear(2 â†’ 256) â†’ ReLU â†’ Dropout    â”‚
â”‚  â†’ Linear(256 â†’ 256)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚  èŠ‚ç‚¹åµŒå…¥: [N, 256]
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     GNNç¼–ç å™¨ (Ã—3å±‚)                  â”‚
â”‚  GCNConv â†’ ReLU â†’ Dropout (Ã—3)       â”‚
â”‚  ã€æ©ç èŠ‚ç‚¹é€šè¿‡æ¶ˆæ¯ä¼ é€’èšåˆé‚»å±…ä¿¡æ¯ã€‘  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                          â”‚                  â”‚
                â–¼  èŠ‚ç‚¹åµŒå…¥: [N, 256]      â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   å›¾çº§åˆ«æ± åŒ–           â”‚   â”‚  ç‰¹å¾è§£ç å™¨       â”‚  â”‚ é“¾æ¥è§£ç å™¨   â”‚
    â”‚  MeanâŠ•Max â†’ [1, 512]  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ (è¾…åŠ©ä»»åŠ¡)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚ Linear     â”‚  â”‚  â”‚             â”‚
               â”‚                â”‚  â”‚ 256â†’256    â”‚  â”‚  â”‚ é‡å»ºè¾¹è¿æ¥   â”‚
               â–¼                â”‚  â”‚ â†’ReLU      â”‚  â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚ â†’Linear    â”‚  â”‚        â”‚
    â”‚  å›¾åµŒå…¥æŠ•å½±å±‚          â”‚   â”‚  â”‚ 256â†’2      â”‚  â”‚        â”‚
    â”‚  Linear(512â†’256)      â”‚   â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚
    â”‚  â†’ReLUâ†’Dropout        â”‚   â”‚        â”‚         â”‚        â”‚
    â”‚  â†’Linear(256â†’128)     â”‚   â”‚        â–¼         â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  é‡å»ºç‰¹å¾:        â”‚        â”‚
               â”‚                â”‚  [N, 2]          â”‚        â”‚
               â–¼                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                                       â”‚                    â”‚
       ã€å›¾åµŒå…¥ zã€‘                     â”‚                    â”‚
         [1, 128] â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                    â”‚
                                      â”‚â”‚                    â”‚
                                      â”‚â”‚                    â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚            åŒä»»åŠ¡æŸå¤±å‡½æ•°                         â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ ç‰¹å¾é‡å»ºæŸå¤±       â”‚  é“¾æ¥é‡å»ºæŸå¤±         â”‚  â”‚
    â”‚  â”‚ L_feature         â”‚  L_link              â”‚  â”‚
    â”‚  â”‚                   â”‚                      â”‚  â”‚
    â”‚  â”‚ ä»…å¯¹è¢«æ©ç èŠ‚ç‚¹è®¡ç®— â”‚  è¾¹è¿æ¥BCEæŸå¤±        â”‚  â”‚
    â”‚  â”‚ MSE(é¢„æµ‹, çœŸå®)   â”‚  (è¾…åŠ©ä»»åŠ¡)          â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚            â”‚                   â”‚               â”‚
    â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚                       â–¼                        â”‚
    â”‚        L_total = L_feature + Î»Â·L_link         â”‚
    â”‚                 (Î» = 0.3)                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ ¸å¿ƒåˆ›æ–°:
1. æ©ç é¢„è®­ç»ƒ: éšæœºæ©ç›–15%èŠ‚ç‚¹ç‰¹å¾ï¼Œå¼ºåˆ¶æ¨¡å‹å­¦ä¹ é²æ£’è¡¨ç¤º
2. åŒä»»åŠ¡å­¦ä¹ : ç‰¹å¾é‡å»º(ä¸») + é“¾æ¥é¢„æµ‹(è¾…)
3. å¯å­¦ä¹ æ©ç token: è‡ªé€‚åº”å­¦ä¹ æœ€ä¼˜æ©ç è¡¨ç¤º
```

### 4ï¸âƒ£ å®Œæ•´è®­ç»ƒä¸è¯„ä¼°æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å›¾è‡ªç¼–ç å™¨è®­ç»ƒä¸è¯„ä¼°å®Œæ•´æµç¨‹                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚  åŸå§‹æ•°æ®å‡†å¤‡     â”‚
                               â”‚  ego_graphs.pkl  â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚     æ•°æ®é¢„å¤„ç†ä¸è½¬æ¢              â”‚
                     â”‚  â€¢ NetworkX â†’ PyG Data           â”‚
                     â”‚  â€¢ æå–èŠ‚ç‚¹/è¾¹ç‰¹å¾                â”‚
                     â”‚  â€¢ ç¼–ç é“è·¯ç±»å‹                  â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚   æ•°æ®é›†åˆ’åˆ†         â”‚
                     â”‚  Train: 80%         â”‚
                     â”‚  Val:   20%         â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â–¼             â–¼             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  è®­ç»ƒ GAE     â”‚ â”‚  è®­ç»ƒ VGAE   â”‚ â”‚  è®­ç»ƒ GraphMAE â”‚
                    â”‚               â”‚ â”‚              â”‚ â”‚                â”‚
                    â”‚  â€¢ ç¼–ç å™¨     â”‚ â”‚  â€¢ ç¼–ç å™¨    â”‚ â”‚  â€¢ æ©ç ç¼–ç å™¨  â”‚
                    â”‚  â€¢ è§£ç å™¨     â”‚ â”‚  â€¢ å˜åˆ†å±‚    â”‚ â”‚  â€¢ åŒè§£ç å™¨    â”‚
                    â”‚  â€¢ é‡å»ºæŸå¤±   â”‚ â”‚  â€¢ è§£ç å™¨    â”‚ â”‚  â€¢ åŒä»»åŠ¡æŸå¤±  â”‚
                    â”‚               â”‚ â”‚  â€¢ Recon+KL  â”‚ â”‚                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚                â”‚                 â”‚
                            â”‚   æ¯ä¸ªEpochæ‰§è¡Œ:                 â”‚
                            â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                            â”‚   â”‚ 1. å‰å‘ä¼ æ’­è®¡ç®—æŸå¤±      â”‚   â”‚
                            â”‚   â”‚ 2. åå‘ä¼ æ’­æ›´æ–°å‚æ•°      â”‚   â”‚
                            â”‚   â”‚ 3. éªŒè¯é›†è¯„ä¼°æ€§èƒ½        â”‚   â”‚
                            â”‚   â”‚ 4. è®°å½•è®­ç»ƒæŒ‡æ ‡          â”‚   â”‚
                            â”‚   â”‚ 5. ä¿å­˜æœ€ä½³æ¨¡å‹          â”‚   â”‚
                            â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                            â”‚                â”‚                 â”‚
                            â–¼                â–¼                 â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚              éªŒè¯é›†è¯„ä¼°æŒ‡æ ‡                       â”‚
                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                  â”‚  â”‚ Val Loss â”‚ Precisionâ”‚ Accuracy â”‚   AUC    â”‚  â”‚
                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                  â”‚                                                  â”‚
                  â”‚  æœ€ä½³æ¨¡å‹ä¿å­˜ç­–ç•¥: ä¿å­˜æœ€é«˜val_aucçš„æ¨¡å‹          â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚           è®­ç»ƒç»“æœè¾“å‡º                       â”‚
                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                  â”‚  â”‚ æ¨¡å‹æƒé‡          â”‚ å›¾åµŒå…¥              â”‚  â”‚
                  â”‚  â”‚ â€¢ gae_model.pt   â”‚ â€¢ gae_embeddings   â”‚  â”‚
                  â”‚  â”‚ â€¢ vgae_model.pt  â”‚ â€¢ vgae_embeddings  â”‚  â”‚
                  â”‚  â”‚ â€¢ mae_model.pt   â”‚ â€¢ mae_embeddings   â”‚  â”‚
                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                  â”‚  â”‚ è®­ç»ƒå†å²          â”‚ è®­ç»ƒæ›²çº¿            â”‚  â”‚
                  â”‚  â”‚ â€¢ history.npy    â”‚ â€¢ curves.png       â”‚  â”‚
                  â”‚  â”‚   - train_loss   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
                  â”‚  â”‚   - val_loss     â”‚   â”‚Loss  â”‚Prec  â”‚  â”‚  â”‚
                  â”‚  â”‚   - val_prec     â”‚   â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
                  â”‚  â”‚   - val_acc      â”‚   â”‚Acc   â”‚Comb  â”‚  â”‚  â”‚
                  â”‚  â”‚   - val_auc      â”‚   â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚         æ¨¡å‹å¯¹æ¯”è¯„ä¼°                         â”‚
                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                  â”‚  â”‚ evaluate_autoencoders.py               â”‚ â”‚
                  â”‚  â”‚                                        â”‚ â”‚
                  â”‚  â”‚ 1. åŠ è½½ä¸‰ä¸ªæ¨¡å‹çš„è®­ç»ƒå†å²               â”‚ â”‚
                  â”‚  â”‚ 2. å¯¹æ¯”æ€§èƒ½æŒ‡æ ‡                        â”‚ â”‚
                  â”‚  â”‚ 3. ç”Ÿæˆå¯¹æ¯”å›¾è¡¨ (2Ã—3)                  â”‚ â”‚
                  â”‚  â”‚    â”œâ”€ Train Loss vs Val Loss          â”‚ â”‚
                  â”‚  â”‚    â”œâ”€ Precision Comparison            â”‚ â”‚
                  â”‚  â”‚    â”œâ”€ Accuracy Comparison             â”‚ â”‚
                  â”‚  â”‚    â”œâ”€ AUC Comparison                  â”‚ â”‚
                  â”‚  â”‚    â”œâ”€ Final Metrics Bar Chart         â”‚ â”‚
                  â”‚  â”‚    â””â”€ Model Summary Table             â”‚ â”‚
                  â”‚  â”‚                                        â”‚ â”‚
                  â”‚  â”‚ 4. åµŒå…¥ç©ºé—´å¯è§†åŒ– (t-SNE)              â”‚ â”‚
                  â”‚  â”‚    â”œâ”€ GAE embeddings                  â”‚ â”‚
                  â”‚  â”‚    â”œâ”€ VGAE embeddings                 â”‚ â”‚
                  â”‚  â”‚    â””â”€ GraphMAE embeddings             â”‚ â”‚
                  â”‚  â”‚                                        â”‚ â”‚
                  â”‚  â”‚ 5. å¯¼å‡ºæ€§èƒ½å¯¹æ¯”è¡¨æ ¼ (CSV)              â”‚ â”‚
                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚          æœ€ç»ˆè¾“å‡º                            â”‚
                  â”‚                                             â”‚
                  â”‚  ğŸ“Š å¯è§†åŒ–ç»“æœ:                             â”‚
                  â”‚    â€¢ models_comparison.png (6å­å›¾)         â”‚
                  â”‚    â€¢ embeddings_comparison.png (t-SNE)     â”‚
                  â”‚                                             â”‚
                  â”‚  ğŸ“ˆ æ€§èƒ½æŠ¥å‘Š:                               â”‚
                  â”‚    â€¢ model_comparison_table.csv            â”‚
                  â”‚                                             â”‚
                  â”‚  ğŸ’¾ æ¨¡å‹äº§ç‰©:                               â”‚
                  â”‚    â€¢ 3ä¸ªæœ€ä½³æ¨¡å‹ (best_*.pt)                â”‚
                  â”‚    â€¢ 3ç»„å›¾åµŒå…¥ (*_embeddings.pt)            â”‚
                  â”‚    â€¢ å½¢çŠ¶: [num_graphs, 128]               â”‚
                  â”‚                                             â”‚
                  â”‚  âœ… ç”¨äºä¸‹æ¸¸ä»»åŠ¡:                           â”‚
                  â”‚    â€¢ å›¾åˆ†ç±»/èšç±»                            â”‚
                  â”‚    â€¢ ç›¸ä¼¼åº¦è®¡ç®—                             â”‚
                  â”‚    â€¢ å¼ºåŒ–å­¦ä¹ çŠ¶æ€è¡¨ç¤º                       â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¿è¡Œå‘½ä»¤:
  â€¢ å•ä¸ªæ¨¡å‹:    python train_gae.py / train_vgae.py / train_graphmae.py
  â€¢ æ‰¹é‡è®­ç»ƒ:    python train_all_models.py
  â€¢ å¿«é€Ÿæµ‹è¯•:    python test_models_quick.py
  â€¢ å¯¹æ¯”è¯„ä¼°:    python evaluate_autoencoders.py
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

```bash
torch >= 1.10.0
torch-geometric >= 2.0.0
numpy
matplotlib
scikit-learn
pandas
seaborn
```

### 2. æ•°æ®å‡†å¤‡

ç¡®ä¿æ•°æ®æ–‡ä»¶å­˜åœ¨ï¼š
```
models/data/ego_graphs.pkl
```

æ•°æ®æ ¼å¼ï¼šåŒ…å«NetworkXå›¾çš„åˆ—è¡¨ï¼Œæ¯ä¸ªå›¾åŒ…å«ï¼š
- èŠ‚ç‚¹ç‰¹å¾ï¼š`degree`ï¼ˆåº¦æ•°ï¼‰ã€`centrality`ï¼ˆä¸­å¿ƒæ€§ï¼‰
- è¾¹ç‰¹å¾ï¼š`highway`ï¼ˆç±»å‹ï¼‰ã€`width`ï¼ˆå®½åº¦ï¼‰ã€`length`ï¼ˆé•¿åº¦ï¼‰

### 3. å¿«é€Ÿæµ‹è¯•

éªŒè¯æ¨¡å‹æ˜¯å¦èƒ½æ­£å¸¸è¿è¡Œï¼š

```bash
cd models/scripts
python test_models_quick.py
```

### 4. è®­ç»ƒæ¨¡å‹

#### æ–¹å¼1ï¼šè®­ç»ƒå•ä¸ªæ¨¡å‹

```bash
# è®­ç»ƒGAE
python train_gae.py

# è®­ç»ƒVGAE
python train_vgae.py

# è®­ç»ƒGraphMAE
python train_graphmae.py
```

#### æ–¹å¼2ï¼šæ‰¹é‡è®­ç»ƒæ‰€æœ‰æ¨¡å‹

```bash
python train_all_models.py
```

### 5. å¯¹æ¯”è¯„ä¼°

```bash
python evaluate_autoencoders.py
```

## ğŸ“Š è¾“å‡ºç»“æœ

### æ¯ä¸ªæ¨¡å‹äº§ç”Ÿçš„æ–‡ä»¶

```
models/
â”œâ”€â”€ gnn_models/
â”‚   â”œâ”€â”€ gae_model.pt                    # GAEæœ€ç»ˆæ¨¡å‹
â”‚   â”œâ”€â”€ best_gae_model.pt               # GAEæœ€ä½³æ¨¡å‹
â”‚   â”œâ”€â”€ vgae_model.pt                   # VGAEæœ€ç»ˆæ¨¡å‹
â”‚   â”œâ”€â”€ best_vgae_model.pt              # VGAEæœ€ä½³æ¨¡å‹
â”‚   â”œâ”€â”€ graphmae_model.pt               # GraphMAEæœ€ç»ˆæ¨¡å‹
â”‚   â””â”€â”€ best_graphmae_model.pt          # GraphMAEæœ€ä½³æ¨¡å‹
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ gae_embeddings.pt               # GAEå›¾åµŒå…¥
â”‚   â”œâ”€â”€ vgae_embeddings.pt              # VGAEå›¾åµŒå…¥
â”‚   â”œâ”€â”€ graphmae_embeddings.pt          # GraphMAEå›¾åµŒå…¥
â”‚   â”œâ”€â”€ gae_training_history.npy        # GAEè®­ç»ƒå†å²
â”‚   â”œâ”€â”€ vgae_training_history.npy       # VGAEè®­ç»ƒå†å²
â”‚   â””â”€â”€ graphmae_training_history.npy   # GraphMAEè®­ç»ƒå†å²
â””â”€â”€ outputs/
    â”œâ”€â”€ gae_training_curves.png         # GAEè®­ç»ƒæ›²çº¿ï¼ˆ2Ã—2ï¼‰
    â”œâ”€â”€ vgae_training_curves.png        # VGAEè®­ç»ƒæ›²çº¿ï¼ˆ2Ã—2ï¼‰
    â”œâ”€â”€ graphmae_training_curves.png    # GraphMAEè®­ç»ƒæ›²çº¿ï¼ˆ2Ã—2ï¼‰
    â”œâ”€â”€ models_comparison.png           # ä¸‰æ¨¡å‹å¯¹æ¯”ï¼ˆ2Ã—3ï¼‰
    â”œâ”€â”€ embeddings_comparison.png       # åµŒå…¥å¯è§†åŒ–ï¼ˆt-SNEï¼‰
    â””â”€â”€ model_comparison_table.csv      # æ€§èƒ½å¯¹æ¯”è¡¨æ ¼
```

### å›¾åµŒå…¥æ ¼å¼

æ¯ä¸ªæ¨¡å‹çš„åµŒå…¥æ–‡ä»¶åŒ…å«ï¼š

```python
{
    'embeddings': Tensor,      # [num_graphs, embedding_dim]
    'graph_ids': List[int],    # å›¾IDåˆ—è¡¨
    'config': Dict             # æ¨¡å‹é…ç½®
}
```

### è®­ç»ƒæ›²çº¿å¸ƒå±€

æ¯ä¸ªæ¨¡å‹çš„è®­ç»ƒæ›²çº¿åŒ…å«4ä¸ªå­å›¾ï¼š
- **å·¦ä¸Š**: Train Loss vs Val Loss
- **å³ä¸Š**: Val Precision
- **å·¦ä¸‹**: Val Accuracy  
- **å³ä¸‹**: ç»„åˆæŒ‡æ ‡ï¼ˆPrecision + Accuracy + AUCï¼‰

## âš™ï¸ é…ç½®æ–‡ä»¶è¯¦è§£

### é€šç”¨å‚æ•°

```json
{
  "model": {
    "node_features": 2,        // èŠ‚ç‚¹ç‰¹å¾ç»´åº¦
    "edge_features": 3,        // è¾¹ç‰¹å¾ç»´åº¦
    "hidden_dim": 256,         // éšè—å±‚ç»´åº¦
    "embedding_dim": 128,      // å›¾åµŒå…¥ç»´åº¦ï¼ˆé‡è¦ï¼ï¼‰
    "num_layers": 3,           // GNNå±‚æ•°
    "dropout": 0.2,            // Dropoutç‡
    "conv_type": "gcn"         // å·ç§¯ç±»å‹ï¼šgcn/gat/sage
  },
  "training": {
    "num_epochs": 100,         // è®­ç»ƒè½®æ•°
    "learning_rate": 0.001,    // å­¦ä¹ ç‡
    "weight_decay": 1e-5,      // L2æ­£åˆ™åŒ–
    "train_ratio": 0.8,        // è®­ç»ƒé›†æ¯”ä¾‹
    "val_ratio": 0.2,          // éªŒè¯é›†æ¯”ä¾‹
    "seed": 42                 // éšæœºç§å­
  }
}
```

### VGAEç‰¹æœ‰å‚æ•°

```json
{
  "training": {
    "kl_weight": 0.1           // KLæ•£åº¦æƒé‡
  },
  "loss": {
    "kl_annealing": {
      "enabled": true,         // å¯ç”¨KLé€€ç«
      "start_weight": 0.01,    // èµ·å§‹æƒé‡
      "end_weight": 0.1,       // ç»“æŸæƒé‡
      "anneal_epochs": 30      // é€€ç«è½®æ•°
    }
  }
}
```

### GraphMAEç‰¹æœ‰å‚æ•°

```json
{
  "model": {
    "mask_ratio": 0.15         // èŠ‚ç‚¹æ©ç æ¯”ä¾‹
  },
  "training": {
    "link_weight": 0.3         // é“¾æ¥é¢„æµ‹æŸå¤±æƒé‡
  }
}
```

## ğŸ”§ é«˜çº§ä½¿ç”¨

### åŠ è½½å’Œä½¿ç”¨å›¾åµŒå…¥

```python
import torch

# åŠ è½½åµŒå…¥
data = torch.load('models/data/vgae_embeddings.pt')
embeddings = data['embeddings']  # [100, 128]
graph_ids = data['graph_ids']

# è®¡ç®—å›¾ç›¸ä¼¼åº¦
similarity_matrix = torch.mm(embeddings, embeddings.t())

# æ‰¾åˆ°æœ€ç›¸ä¼¼çš„å›¾
graph_idx = 0
similarities = similarity_matrix[graph_idx]
top_k_similar = torch.topk(similarities, k=5)
print(f"ä¸å›¾ {graph_idx} æœ€ç›¸ä¼¼çš„å›¾: {top_k_similar.indices}")
```

### åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œæ¨ç†

```python
from vgae_model import create_vgae_model
from autoencoder_utils import load_config, convert_ego_graphs_to_pytorch

# åŠ è½½é…ç½®å’Œæ¨¡å‹
config = load_config('models/config/vgae_config.json')
model = create_vgae_model(config['model'])
model.load_state_dict(torch.load('models/gnn_models/best_vgae_model.pt'))
model.eval()

# åŠ è½½æ•°æ®
graphs = convert_ego_graphs_to_pytorch('models/data/ego_graphs.pkl')

# æ¨ç†
with torch.no_grad():
    for graph in graphs:
        embedding = model.get_graph_embedding(graph)
        print(f"å›¾åµŒå…¥: {embedding.shape}")
```

### è‡ªå®šä¹‰å›¾æ± åŒ–ç­–ç•¥

ä¿®æ”¹æ¨¡å‹ç¼–ç å™¨ä¸­çš„æ± åŒ–æ–¹å¼ï¼š

```python
# å½“å‰ï¼šMean + Max Pooling
mean_pool = global_mean_pool(h, batch)
max_pool = global_max_pool(h, batch)
graph_rep = torch.cat([mean_pool, max_pool], dim=1)

# å¯é€‰ï¼šä»…ä½¿ç”¨Mean Pooling
graph_rep = global_mean_pool(h, batch)

# å¯é€‰ï¼šæ·»åŠ Sum Pooling
from torch_geometric.nn import global_add_pool
sum_pool = global_add_pool(h, batch)
graph_rep = torch.cat([mean_pool, max_pool, sum_pool], dim=1)
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### æå‡è®­ç»ƒé€Ÿåº¦
- ä½¿ç”¨GPUï¼š`device = 'cuda'`
- å‡å° `hidden_dim` å’Œ `embedding_dim`
- å‡å°‘ `num_layers`
- å¢å¤§ `batch_size`ï¼ˆéœ€ä¿®æ”¹DataLoaderï¼‰

### æå‡æ¨¡å‹æ€§èƒ½
- å¢åŠ  `hidden_dim` å’Œ `num_layers`
- ä½¿ç”¨ `conv_type: "gat"`ï¼ˆæ³¨æ„åŠ›æœºåˆ¶ï¼‰
- è°ƒæ•´å­¦ä¹ ç‡è°ƒåº¦ç­–ç•¥
- å¢åŠ è®­ç»ƒè½®æ•°

### é’ˆå¯¹VGAE
- è°ƒæ•´ `kl_weight`ï¼ˆå»ºè®®0.01-0.5ï¼‰
- å¯ç”¨KLé€€ç«

### é’ˆå¯¹GraphMAE
- è°ƒæ•´ `mask_ratio`ï¼ˆå»ºè®®0.1-0.3ï¼‰
- è°ƒæ•´ `link_weight`ï¼ˆå»ºè®®0.2-0.5ï¼‰

## ğŸ“Š è¯„ä¼°æŒ‡æ ‡è¯´æ˜

### é“¾æ¥é¢„æµ‹æŒ‡æ ‡

- **Loss**: é‡å»ºæŸå¤±ï¼Œè¶Šä½è¶Šå¥½
- **Precision**: ç²¾ç¡®ç‡ï¼ŒèŒƒå›´[0, 1]ï¼Œè¶Šé«˜è¶Šå¥½
- **Accuracy**: å‡†ç¡®ç‡ï¼ŒèŒƒå›´[0, 1]ï¼Œè¶Šé«˜è¶Šå¥½
- **AUC**: ROCæ›²çº¿ä¸‹é¢ç§¯ï¼ŒèŒƒå›´[0, 1]ï¼Œè¶Šé«˜è¶Šå¥½ï¼ˆ**ä¸»è¦æŒ‡æ ‡**ï¼‰
- **AP**: å¹³å‡ç²¾åº¦ï¼ŒèŒƒå›´[0, 1]ï¼Œè¶Šé«˜è¶Šå¥½

### æœ€ä½³æ¨¡å‹ä¿å­˜ç­–ç•¥

é»˜è®¤æŒ‰ `val_auc` ä¿å­˜æœ€ä½³æ¨¡å‹ï¼Œå¯ä¿®æ”¹ä¸ºå…¶ä»–æŒ‡æ ‡ï¼š

```python
# åœ¨è®­ç»ƒè„šæœ¬ä¸­ä¿®æ”¹
if val_metrics['precision'] > best_val_precision:
    best_val_precision = val_metrics['precision']
    torch.save(model.state_dict(), config['paths']['best_model_save'])
```

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜1: CUDA out of memory
**è§£å†³æ–¹æ¡ˆ**:
- å‡å° `hidden_dim` å’Œ `embedding_dim`
- ä½¿ç”¨CPUè®­ç»ƒ
- å‡å°‘å›¾çš„æ•°é‡

### é—®é¢˜2: è®­ç»ƒæŸå¤±ä¸ä¸‹é™
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥å­¦ä¹ ç‡ï¼ˆå°è¯•0.0001-0.01ï¼‰
- æ£€æŸ¥æ•°æ®æ˜¯å¦æ­£ç¡®åŠ è½½
- å¢åŠ æ¨¡å‹å®¹é‡ï¼ˆhidden_dimï¼‰

### é—®é¢˜3: éªŒè¯æŒ‡æ ‡ä¸ç¨³å®š
**è§£å†³æ–¹æ¡ˆ**:
- å¢åŠ éªŒè¯é›†å¤§å°
- ä½¿ç”¨å›ºå®šéšæœºç§å­
- å»¶é•¿è®­ç»ƒè½®æ•°

### é—®é¢˜4: åµŒå…¥è´¨é‡å·®
**è§£å†³æ–¹æ¡ˆ**:
- å¢åŠ  `embedding_dim`ï¼ˆå¦‚256ï¼‰
- å¢åŠ  `num_layers`ï¼ˆå¦‚4-5å±‚ï¼‰
- ä½¿ç”¨VGAEè€ŒéGAE
- å»¶é•¿è®­ç»ƒæ—¶é—´

## ğŸ“š å‚è€ƒæ–‡çŒ®

**GAE/VGAE**:
- Kipf, T. N., & Welling, M. (2016). Variational graph auto-encoders. NIPS Workshop on Bayesian Deep Learning.

**GraphMAE**:
- Hou, Z., et al. (2022). GraphMAE: Self-Supervised Masked Graph Autoencoders. KDD 2022.

**PyTorch Geometric**:
- Fey, M., & Lenssen, J. E. (2019). Fast graph representation learning with PyTorch Geometric. ICLR Workshop.

## ğŸ“ é¡¹ç›®ç»“æ„

```
models/
â”œâ”€â”€ scripts/                            # è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ autoencoder_utils.py            # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ gae_model.py                    # GAEæ¨¡å‹
â”‚   â”œâ”€â”€ vgae_model.py                   # VGAEæ¨¡å‹
â”‚   â”œâ”€â”€ graphmae_model.py               # GraphMAEæ¨¡å‹
â”‚   â”œâ”€â”€ train_gae.py                    # GAEè®­ç»ƒ
â”‚   â”œâ”€â”€ train_vgae.py                   # VGAEè®­ç»ƒ
â”‚   â”œâ”€â”€ train_graphmae.py               # GraphMAEè®­ç»ƒ
â”‚   â”œâ”€â”€ train_all_models.py             # æ‰¹é‡è®­ç»ƒ
â”‚   â”œâ”€â”€ evaluate_autoencoders.py        # æ¨¡å‹å¯¹æ¯”
â”‚   â”œâ”€â”€ test_models_quick.py            # å¿«é€Ÿæµ‹è¯•
â”‚   â””â”€â”€ README_AUTOENCODERS.md          # ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ config/                             # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ gae_config.json
â”‚   â”œâ”€â”€ vgae_config.json
â”‚   â””â”€â”€ graphmae_config.json
â”œâ”€â”€ gnn_models/                         # ä¿å­˜çš„æ¨¡å‹
â”œâ”€â”€ data/                               # æ•°æ®å’ŒåµŒå…¥
â””â”€â”€ outputs/                            # å¯è§†åŒ–ç»“æœ
```

## âœ… ä¸‹ä¸€æ­¥å·¥ä½œ

è®­ç»ƒå®Œæˆåï¼Œå¯ä»¥ï¼š

1. **åˆ†æå›¾åµŒå…¥ç©ºé—´**
   - t-SNE/UMAPå¯è§†åŒ–
   - èšç±»åˆ†æ
   - ç›¸ä¼¼åº¦åˆ†æ

2. **ä¸‹æ¸¸ä»»åŠ¡åº”ç”¨**
   - å›¾åˆ†ç±»
   - å›¾èšç±»
   - å¼ºåŒ–å­¦ä¹ çš„çŠ¶æ€è¡¨ç¤º

3. **æ¨¡å‹æ”¹è¿›**
   - å°è¯•ä¸åŒçš„GNNæ¶æ„
   - æ·»åŠ è¾¹ç‰¹å¾ç¼–ç å™¨
   - å®ç°å›¾çº§åˆ«çš„å¯¹æ¯”å­¦ä¹ 

## ğŸ“§ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜è¯·ï¼š
1. æŸ¥çœ‹ `README_AUTOENCODERS.md` è¯¦ç»†æ–‡æ¡£
2. è¿è¡Œ `test_models_quick.py` å¿«é€Ÿè¯Šæ–­
3. æ£€æŸ¥é…ç½®æ–‡ä»¶å‚æ•°è®¾ç½®
4. æŸ¥çœ‹ä»£ç æ³¨é‡Šå’Œdocstrings

